- name: Install golang
  apt:
    name: "{{ packages }}"
  vars:
    packages:
    - golang

- name: Create go bin directory
  become: "{{ lookup('env','USER') }}"
  file:
    path: /home/{{ lookup('env','USER') }}/go/bin
    state: directory
    mode: '0750'
    owner: "{{ lookup('env','USER') }}"
    group: "{{ lookup('env','USER') }}"

- name: Install go dep
  become: "{{ lookup('env','USER') }}"
  shell: curl https://raw.githubusercontent.com/golang/dep/master/install.sh | sh
  args:
    warn: no
    creates: /home/{{ lookup('env','USER') }}/go/bin/dep
